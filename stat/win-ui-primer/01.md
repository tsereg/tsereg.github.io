---
layout: page
title: Preparing for work
---

[Contents](./) | Prev | [Next](02)

## Installing .NET SDK

In this primer we assume .NET 9.0, but any version starting with 8.0 and above should be fine. Consult Microsoft's .NET download page for the currently recommended version.

Verifying installation status by running `dotnet`:

```shell
dotnet --version
```

Looking up and installing the desired .NET SDK using `winget` (install the desired 'Microsoft .NET SDK' by specifying its `Id` from the search results): 

```shell
winget search Microsoft.DotNet
winget install --id Microsoft.DotNet.SDK.9 --source winget
```

## Preparing the project

### Creating the project file

Create a directory for the C# project (henceforth the 'project directory'), then  write the following C# project file in it, naming the file `FooBar.csproj`:

```xml
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net9.0-windows</TargetFramework>
    <OutputType>WinExe</OutputType>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>
```

You should, however, correct the value of the `TargetFramework` element to match the .NET SDK version you have installed and want to use. Use `dotnet --version` to get the newest .NET version installed on the system. You can also search the internet for 'TargetFramework' and lookup older possible target framework values for SDK-style projects on the Microsoft's site. 

Whatever token you have used for .NET version, make sure to append the `-windows` suffix to restrict the build to the Windows platform only.

### Creating the main program file

Create a file named `Program.cs` in the project directory, with the following content:

```csharp
  public static class Program
  {
      static void Main(string[] args)
      {
      }
  }
```

### Building the program

The project should now build without errors (we run the build command from the project directory):

```shell
dotnet build
```

We can also both build and run the program:

```shell
dotnet run
```

Nothing will happen when the program is run: it will start, enter the static `Main` procedure and immediately exit.

## Installing the Windows App SDK

Windows App SDK is a set of APIs used by desktop applications on Windows 11 and Windows 10 (from version 1809). It contains the WinUI 3 component providing WinUI native user experience (UX) framework for Windows desktop applications.

This SDK may already be available on your system, e. g. if Visual Studio desktop development workload is installed. In any case, search for 'Windows App SDK' should discover a web page on Microsoft's web site providing a link for downloading the installer. 

Verifying if the Windows App SDK Runtime is installed using the PowerShell:

```powershell
Get-AppxPackage Microsoft.WindowsAppRuntime.*
```

## Updating the project for Win UI

### Updating the project file

We have to change the `FooBar.csproj` project file as follows:
- set the targeted Windows version, 
- enable use of WinUI framework,
- instruct MSBuild to properly build WinUI application,
- and reference the Windows App SDK NuGet package.

This is what the updated project file should look like:

```xml
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net9.0-windows10.0.19041.0</TargetFramework>
    <OutputType>WinExe</OutputType>
    <UseWinUI>true</UseWinUI>
    <EnableMsixTooling>false</EnableMsixTooling>
    <WindowsPackageType>None</WindowsPackageType>
    <Nullable>enable</Nullable>
    <RuntimeIdentifier>win-x64</RuntimeIdentifier>
  </PropertyGroup>


  <ItemGroup>
    <PackageReference Include="Microsoft.WindowsAppSDK" Version="1.*" />
  </ItemGroup>

</Project>
```

Targeted Windows version is set in the `TargetFramework` element. This number is expected by the Windows App SDK during build and it should be set to one of the supported values. If you specify an unsupported value, the build will stop and all the supported values will be listed. You should pick a newer Windows version.

If `EnableMsixTooling` element isnt't added, a special bootstrap pattern or a native C++ entry point has to be provided for the application to run. 

The `WindowsPackageType` disables packaging (the application will remain unpackaged).

You might also want to update the `PackageReference` element's `Version` attribute to the latest major version of the Windows App SDK supported for the targeted .NET version. The simplest way to find this is to find the package in the NuGet Gallery and look at the PackageReference entry suggested there.

### Building the program

The project should again build and run without errors:

```shell
dotnet run
```

## WinUI Hello World

Create a file named `FooBarWindow.cs` in the project directory, with the following content:

```csharp
using Microsoft.UI.Xaml;

public class FooBarWindow : Window
{
}
```

Update the `Program.cs` to run the application message loop and display the `FooBarWindow`.

```csharp
using System;
using Microsoft.UI.Xaml;

public static class Program
{
    static void Main(string[] args)
    {
        Application.Start(p => _ = new App());
    }

    private class App : Application
    {
        protected override void OnLaunched(LaunchActivatedEventArgs args)
        {
            var window = new FooBarWindow();
            window.Activate();
        }
    }
}
```

### Building the program

Finally, build the project and run the program to display an empty window:

```shell
dotnet run
```

## Contents

{% include_relative contents.md %}
