---
layout: page
title: Preparing for work
---

[Contents]() | Prev | [Next](02)

## Install .NET

Check wether you have .NET already installed by running `dotnet` at the command prompt. If not, then search for 'download .NET' and install whichever .NET version you prefer from the Microsoft's web-site (consult the download page for the recommended version). Verify installation status by running:

{% highlight console %}
dotnet --version
{% endhighlight %}

You may use 'winget' tool aswell. List available .NET packages:

{% highlight console %}
winget search Microsoft.DotNet
{% endhighlight %}

Install the desired 'Microsoft .NET SDK' by specifying its `Id`:

{% highlight console %}
winget install --id Microsoft.DotNet.SDK.9 --source winget
{% endhighlight %}

## Prepare the project

### Create the project file

Create a directory for the C# project and create a file named `FooBar.csproj` in your project. You can, of course, use any other name instead of `FooBar`. Here are the contensts of the new file (it's an XML-file):

{% highlight xml %}
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net9.0-windows</TargetFramework>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>
{% endhighlight %}

You should, however, correct the value of the `TargetFramework` element to match .NET SDK version you have installed and want to use. You may also search the internet for 'TargetFramework' and lookup possible target framework values for SDK-style projects. Or use value from a project you have previously built. Or generate a project in a temporary directory using `dotnet` and lift the value from the generated project file:

{% highlight console %}
dotnet new console
{% endhighlight %}

You should always be able to add the `-windows` suffix to restrict the build to the Windows platform only.

### Create the main program file

Create a file named `Program.cs` in your project with the following content:

{% highlight csharp %}
namespace FooBar
{
    public static class Program
    {
        static void Main(string[] args)
        {
        }
    }
}
{% endhighlight %}

### Build the program

The project should build without errors (run from the project directory):

{% highlight console %}
dotnet build
{% endhighlight %}

You can both build and run the program:

{% highlight console %}
dotnet run
{% endhighlight %}

Nothing will happen if you run the program. It will start, enter the static `Main` procedure and immediately exit.

## Install Windows App SDK

Windows App SDK is a set of APIs used by desktop applications on Windows 11 and Windows 10 (from version 1809). It contains the WinUI 3 component providing WinUI native user experience (UX) framework for Windows desktop applications.

Search for 'Windows App SDK' and install it via the installer provided on the Microsoft's web-site. 

To check if Windows App SDK Runtime is installed, use this PowerShell command:

{% highlight powershell %}
Get-AppxPackage Microsoft.WindowsAppRuntime.*
{% endhighlight %}

## Update the project for Win UI

### Update the project file

Change `FooBar.csproj` file as follows:
- set the targeted Windows version, 
- enable use of WinUI framework,
- instruct MSBuild to create a packaged (MSIX-based) desktop application,
- and reference the Windows App SDK NuGet package.

{% highlight xml %}
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net9.0-windows10.0.19041.0</TargetFramework>
    <Nullable>enable</Nullable>
    <UseWinUI>true</UseWinUI>
    <EnableMsixTooling>false</EnableMsixTooling>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.WindowsAppSDK" Version="1.7.250606001" />
  </ItemGroup>

</Project>
{% endhighlight %}

Targeted Windows version is set in the `TargetFramework` element. This number is expected by the Windows App SDK during build and it should be set to one of the supported values. If you specify and unsupported value, the build will stop and all the supported values will be listed. You should pick a newer Windows version.

If `EnableMsixTooling` element isnt't added, a special bootstrap pattern or a native C++ entry point has to be provided for the application to run. This is out of our scope here, so the builder is instructed to create an MSIX package for automatic installing and bootstraping the application.

Update the `PackageReference` elements `Version` attribute to latest version of the Windows App SDK supported for the targeted .NET version. The simplest way to do this is to find the package in the NuGet Gallery and copy the PackageReference entry.

### Build and run the program

The project should again build and run without errors:

{% highlight console %}
dotnet run
{% endhighlight %}

## Contents

{% include_relative contents.md %}
